<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Clue 2 — The Caffeine Code</title>
  <style>
    body{background:#080909;color:#fff;font-family:system-ui;padding:22px}
    .card{max-width:720px;margin:18px auto;background:#0f0f12;padding:20px;border-radius:12px}
    h1{color:#ffd27a;margin:0 0 6px 0}
    p{color:#cfcfcf}
    .btn{display:inline-block;padding:10px 12px;border-radius:10px;background:#57d6ff;color:#021; text-decoration:none;font-weight:600}
    iframe.video{width:100%;height:200px;border:0;border-radius:8px}
    small{color:#9a9a9a}
  </style>
</head>
<body>
  <div class="card">
    <h1>Clue 2 — The Caffeine Code</h1>
    <p>☕ You found the scent of truth… or at least espresso.</p>

    <!-- Optional video (your voice teasing): paste embed src -->
    <!-- <iframe class="video" src="https://www.youtube.com/embed/YOUR_VIDEO_ID?rel=0&autoplay=1" allow="autoplay; encrypted-media"></iframe> -->

    <p><strong>Clue #2:</strong> Go to the place where silence is expected, but whispers and laughter always win.</p>

    <div style="margin-top:14px">
      <a class="btn" href="clue3.html" id="next">Next Clue ➜</a>
      <small style="margin-left:10px">(progress will be recorded)</small>
    </div>
  </div>

<script>
/* CONFIG — same as index.html (replace with your form info) */
const FORM_URL = "https://docs.google.com/forms/d/e/FORM_ID/formResponse";
const ENTRY_PAGE = "entry.1234567890";
const ENTRY_TIMESTAMP = "entry.0987654321";
/* ========================================== */

const PAGE_INDEX = 2;
const PAGE_NAME = "Clue 2 — The Caffeine Code";

function nowISO(){ return new Date().toISOString(); }
function readProgress(){ return parseInt(localStorage.getItem('hunt_progress')||'0',10); }
function updateProgress(){
  const prog = readProgress();
  if(PAGE_INDEX > prog) localStorage.setItem('hunt_progress', PAGE_INDEX.toString());
}
function shouldAllow(){
  const prog = readProgress();
  return prog >= PAGE_INDEX-1; // must have completed previous page
}
function logVisit(){
  if(localStorage.getItem('logged_'+PAGE_INDEX)) return;
  localStorage.setItem('logged_'+PAGE_INDEX, nowISO());
  const timestamp = new Date().toLocaleString();
  const url = FORM_URL + "?" + ENTRY_PAGE + "=" + encodeURIComponent(PAGE_NAME) + "&" + ENTRY_TIMESTAMP + "=" + encodeURIComponent(timestamp);
  fetch(url, { mode: 'no-cors' });
}
function updateTimerUI(){
  const start = parseInt(localStorage.getItem('hunt_start')||'0',10);
  const el = document.getElementById('globalTimer');
  if(!el) return;
  if(!start){ el.textContent = "24:00:00"; return; }
  const end = start + 24*3600*1000;
  const rem = Math.max(0, end - Date.now());
  const hh = Math.floor(rem/3600000).toString().padStart(2,'0');
  const mm = Math.floor((rem%3600000)/60000).toString().padStart(2,'0');
  const ss = Math.floor((rem%60000)/1000).toString().padStart(2,'0');
  el.textContent = `${hh}:${mm}:${ss}`;
}

// Inject minimal header with timer
(function initUI(){
  const header = document.createElement('div');
  header.style.display='flex'; header.style.justifyContent='space-between'; header.style.alignItems='center';
  header.innerHTML = `<div style="font-weight:700">Mystery of Livingston</div><div id="globalTimer" style="font-weight:700">24:00:00</div>`;
  document.body.insertBefore(header, document.body.firstChild);
  setInterval(updateTimerUI, 1000);
})();

(function init(){
  if(!shouldAllow()){
    // block and tell them to start at Gates Hall
    document.body.innerHTML = `<div style="padding:28px;color:#ffd2a6;font-family:system-ui">
      <h2 style="color:#ff9a66">Hold up — start at Gates Hall</h2>
      <p>You need to scan the first QR at Gates Hall to begin. Return there and start the hunt.</p>
      <a href="index.html" style="display:inline-block;margin-top:12px;padding:10px 12px;background:#ff6b6b;color:#111;border-radius:10px;text-decoration:none;font-weight:700">Go to start</a>
    </div>`;
    return;
  }
  updateProgress();
  logVisit();
})();
</script>
</body>
</html>
