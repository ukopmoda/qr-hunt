<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Good luck you got this!</title>
  <style>
    body {
      font-family: monospace;
      background-color: black;
      color: white;
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      text-align: center;
    }

    #intro {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    #flicker-text {
      font-size: 3rem;
      animation: brokenFlicker 12s infinite;
      transition: opacity 0.1s ease-in-out;
    }

    @keyframes brokenFlicker {
      0%, 4%, 9%, 11%, 18%, 25%, 27%, 39%, 46%, 48%, 52%, 60%, 68%, 72%, 80%, 88%, 92%, 100% {
        opacity: 1;
      }
      5%, 10%, 12%, 19%, 26%, 28%, 40%, 47%, 49%, 53%, 61%, 69%, 73%, 81%, 89%, 93% {
        opacity: 0.1;
      }
    }

    #timer {
      font-size: 2em;
      margin-top: 20px;
      display: none;
    }

    #message {
      margin-top: 30px;
      display: none;
      font-size: 1.2em;
    }

    button {
      background: #222;
      border: 1px solid #444;
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.2s;
      margin-top: 30px;
    }

    button:hover {
      background: #444;
    }
  </style>
</head>
<body>
  <div id="intro">
    <h1 id="flicker-text">Hey Berkeley</h1>
    <button id="startBtn">Start the Hunt</button>
  </div>

  <div id="timer">Time: <span id="timeDisplay">0:00</span></div>
  <div id="message"></div>

  <script>
    const startBtn = document.getElementById("startBtn");
    const timerDiv = document.getElementById("timer");
    const messageDiv = document.getElementById("message");
    const introDiv = document.getElementById("intro");
    const timeDisplay = document.getElementById("timeDisplay");

    let startTime = null;
    let timerInterval = null;

    function updateTimer() {
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      const minutes = Math.floor(elapsed / 60);
      const seconds = elapsed % 60;
      timeDisplay.textContent = `${minutes}:${seconds.toString().padStart(2, "0")}`;
    }

    function logToGoogleForm(pageVisited, timestamp) {
      const formURL =
        "https://docs.google.com/forms/d/e/1FAIpQLSc98vrMFB93dOJ-VO84kGNkERM6wAb-ENA1UZ9I4gpdsrPKmg/formResponse";
      const params = new URLSearchParams();
      params.append("entry.1204348624", pageVisited);
      params.append("entry.2081435125", timestamp);

      fetch(formURL, {
        method: "POST",
        mode: "no-cors",
        body: params
      });
    }

    function startTimer() {
      startTime = Date.now();
      timerInterval = setInterval(updateTimer, 1000);
      updateTimer();
    }

    startBtn.addEventListener("click", () => {
      introDiv.style.display = "none";
      timerDiv.style.display = "block";
      messageDiv.style.display = "block";
      messageDiv.textContent = "The north wind is always colder than the south..... or is it? Run, Even Crawl, find yourself above them all. To find the next clue you'll need some gall, your treasure awaits atop the wall!";

      startTimer();
      const timestamp = new Date().toLocaleString();
      logToGoogleForm("Good luck you got this!", timestamp);
    });

    // Auto-start if URL contains ?start=true
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get("start") === "true") {
      introDiv.style.display = "none";
      timerDiv.style.display = "block";
      messageDiv.style.display = "block";
      messageDiv.textContent = "The north wind is always colder than the south..... or is it? Run, Even Crawl, find yourself above them all. To find the next clue you'll need some gall, your treasure awaits atop the wall!";

      startTimer();
      const timestamp = new Date().toLocaleString();
      logToGoogleForm("Good luck you got this! (QR Scan)", timestamp);
    }
  </script>
</body>
</html>
