<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Hey Berkington</title>
  <style>
    :root { --bg:#07060a; --accent:#ff6b6b; --muted:#bdbdbd; }
    body{background:var(--bg);color:#fff;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      margin:0;padding:24px;display:flex;flex-direction:column;min-height:100vh;gap:18px}
    header{text-align:center; animation:fadeIn 2s;}
    h1{color:var(--accent);margin:0;font-size:2rem;}
    p.subtext{color:var(--muted);max-width:600px;margin:0 auto;font-size:.95rem;line-height:1.4;}
    main{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px}
    .card{background:#0d0c10;padding:18px;border-radius:12px;max-width:680px;width:100%;box-shadow:0 6px 30px rgba(0,0,0,.6)}
    .timer{font-size:1.25rem;color:#ffd27a;margin-top:12px;}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;background:var(--accent);color:#111;text-decoration:none;font-weight:600;cursor:pointer;border:none}
    iframe.video{width:100%;height:220px;border-radius:8px;border:0}
    small.muted{color: #9a9a9a}
    @keyframes fadeIn { 0% {opacity:0; transform:translateY(-20px);} 100% {opacity:1; transform:translateY(0);} }
  </style>
</head>
<body>
  <header>
    <h1>Hey Berkington</h1>
    <p class="subtext">
      So it's Halloween, yay! I wanted to do a little saw/prop hunt type thing or something. 
      You can ask your friends for help cuz it's lowkey kinda hard, oh and I won't give you any hints haha. 
      Goodluck Berkshire, you have 24 hours!
    </p>
    <div class="timer" id="global-timer">24:00:00</div>
  </header>

  <main>
    <div class="card">
     <h2>Good luck, you got this!</h2>
      <p>ðŸ•’ The clock is ticking â€” 24 hours to uncover the truth.<br>
<p><strong>Clue #1:</strong> 
  The north wind is always colder than the southâ€¦ or is it? <br>
  <strong>Run</strong>, <strong>Even</strong>, <strong>Crawl</strong>, find yourself above them all. <br>
  To find the next clue you'll need some gall â€” your treasure awaits atop the wall!
</p>

      <!-- QR code triggers next clue, button removed -->
        <button class="btn" id="reset-btn">Reset Timer</button>
        <small class="muted">Timer starts only when page is opened via QR code.</small>
      </div>
    </div>

    <p style="font-size:.9rem;color:#9a9a9a;max-width:680px;">
      (This page logs each visit automatically to my private sheet.)
    </p>
  </main>

<script>
/* ===== CONFIG ===== */
const FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSc98vrMFB93dOJ-VO84kGNkERM6wAb-ENA1UZ9I4gpdsrPKmg/formResponse";
const ENTRY_PAGE = "entry.1204348624";
const ENTRY_TIMESTAMP = "entry.2081435125";
const PAGE_INDEX = 1;
const PAGE_NAME = "Good luck, you got this!";
const TOTAL_HOURS = 24;

/* ===== HELPERS ===== */
function nowISO(){ return new Date().toISOString(); }

function saveStartIfNeeded(){
  if(!localStorage.getItem('hunt_start')) localStorage.setItem('hunt_start', Date.now().toString());
}

function updateProgress(){
  let progress = parseInt(localStorage.getItem('hunt_progress')||'0',10);
  if(PAGE_INDEX > progress) localStorage.setItem('hunt_progress', PAGE_INDEX.toString());
}

function logVisit(){
  if(localStorage.getItem('logged_'+PAGE_INDEX)) return;
  localStorage.setItem('logged_'+PAGE_INDEX, nowISO());
  const timestamp = new Date().toLocaleString();
  const url = FORM_URL + "?" + ENTRY_PAGE + "=" + encodeURIComponent(PAGE_NAME) + "&" + ENTRY_TIMESTAMP + "=" + encodeURIComponent(timestamp);
  fetch(url, {mode:'no-cors'}).catch(()=>{});
}

/* ===== TIMER ===== */
let timerInterval; // global variable for the interval

function updateTimerUI() {
  const start = parseInt(localStorage.getItem('hunt_start') || '0', 10);
  const el = document.getElementById('global-timer');
  if (!start) {
    el.textContent = "24:00:00";
    return;
  }
  const end = start + TOTAL_HOURS * 3600 * 1000;
  const rem = Math.max(0, end - Date.now());
  const hh = Math.floor(rem / 3600000).toString().padStart(2, '0');
  const mm = Math.floor((rem % 3600000) / 60000).toString().padStart(2, '0');
  const ss = Math.floor((rem % 60000) / 1000).toString().padStart(2, '0');
  el.textContent = `${hh}:${mm}:${ss}`;
}

function startTimer() {
  // clear any previous timer interval
  if (timerInterval) clearInterval(timerInterval);

  // save start time if not already set
  if (!localStorage.getItem('hunt_start')) {
    localStorage.setItem('hunt_start', Date.now().toString());
  }

  // update immediately
  updateTimerUI();

  // start interval
  timerInterval = setInterval(updateTimerUI, 1000);
}

function resetTimer() {
  const password = prompt("Enter password to reset the timer:");
  if (password === "YOURSECRET") {
    // reset the start time
    localStorage.setItem('hunt_start', Date.now().toString());

    // stop previous interval
    if (timerInterval) clearInterval(timerInterval);

    // restart timer
    startTimer();

    alert("Timer reset!");
  } else {
    alert("Wrong password!");
  }
}


document.getElementById('reset-btn').addEventListener('click', resetTimer);

/* ===== INIT ===== */
(function init(){
  const urlParams = new URLSearchParams(window.location.search);
  if(urlParams.get("start") === "true"){
    // Only start timer and log visit if QR code triggered
    saveStartIfNeeded();
    updateProgress();
    logVisit();
    updateTimerUI();
    setInterval(updateTimerUI, 1000);
  } else {
    // If not started via QR, show static timer
    document.getElementById('global-timer').textContent = "24:00:00";
  }
})();
</script>

</body>
</html>
